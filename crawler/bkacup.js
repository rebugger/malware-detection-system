var request = require("request");
var cheerio = require('cheerio');
var fs = require('fs')

module.exports = function(list) {
    console.log(list.Ulist.length)
    var cnt = 0;
    var url = list.Ulist;
    console.log('url test test test  : ', url)
    for(var x = 0; x < url.length; x++){
        request(url[x], function(error, response, body) {
            var test = url[x];

            console.log('adskjvlzxcjvlasdjlfjasdlfjiadlsjfojadslfadlsfoj : ', test)
            if (error) throw error;
            if(!error && response.statusCode == 200){
                var $ = cheerio.load(body,{
                    // normalizeWhitespace: false,
                    xmlMode: false,
                    // decodeEntities: true
                });
                    
                $('script').each(function(){
                    var src = $(this).attr("src");
                    
                    if(typeof(src) !== 'undefined'){
                        console.log('JS : %s', src + ' : '+ test)
                    }
                })
            }
            else{
                console.log('ERR: %j\t%j',error,response.statusCode);
            }
            // else{
            //     console.log("fuck", ++cnt)
            //     console.log(' %s 상태코드 : ',url[x] + response.statusCode)
            // }
        });      
        console.log('count %s' , cnt++)
    }
    
    
    
    
    
    
    
    var dataPush = (data, checkNum) => {
        var checker = checkNum;
    
        console.log('Check : checker  : ', checker +' : '+typeof(checker))
        if(checker !== 0){
            fs.writeFileSync('./log/found.json', data , "utf8");
        }
        else{
            fs.writeFileSync('./log/error.json', data , "utf8");
        }
    }
    
    var dataCheck = (data) => {
        var total = [];
        var list = data;
        if(list.indexOf('h') !== -1){
            
        }
    }
}