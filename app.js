
var mongoose = require('mongoose');
mongoose.Promise = global.Promise;
var path = require('path');
var bodyParser = require('body-parser');
var express = require('express');
var fs = require('fs')
var request = require("request");  
var cheerio = require('cheerio');
var iconv = require('iconv-lite');
//---------------------------------------
var config = require('./config/config');

//---------------------------------------

var app = express();
var server = require('http').createServer(app).listen(config.HTTP_PORT);
var database = require('./config/db')();  //database 연결 및 실행


var c1_list = JSON.parse(fs.readFileSync('./url_list/check_list.json', 'utf8'));
var c2_list = JSON.parse(fs.readFileSync('./pattern/pattern.json', 'utf8'));
// -------- crawler --------
var c_1_hrefFind = require('./crawler/href')(c1_list);
var c1_scriptFind = require('./crawler/script')(c1_list);
var c1_imgFind = require('./crawler/img')(c1_list);

var c2_a_href = require('./crawler2/href_check')(c2_list);

// -------- crawler2 --------
// var check_script = require('./crawler2/href_check.js')('1');



// app.use(express.static(__dirname + 'log'));

app.use(bodyParser.urlencoded({ extended: false }));
// app.use(require('./route/route.js'));

app.use(function(err, req, res, next) {
    console.error(err.stack);
    res.status(500).send('Something broke!');
  });







